library(ggplot2)
library(dplyr)
tableau_data <- read.csv("~/Downloads/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
unique_PT_ID <- unique(tableau_data$PT.ID)
unique_PT_ID <- unique_PT_ID[unique_PT_ID != "null"]
diagnosed_table <- tableau_data[tableau_data$Diagnosis != "",]
table_diagnosis <- as.data.frame(table(unique(diagnosed_table[c("PT.ID", "Diagnosis")])$Diagnosis))
table_diagnosis <- table_diagnosis[-1,]
cbbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7",  "#00CC33",  "#FF0033",  "#660099")
mapped_occurences <- tail(sort(table_diagnosis$Freq), 10)
mapped_occurences <- data.frame(Freq=mapped_occurences, color=1:10)
mapped_occurences$pallet <- cbbPalette
table_diagnosis <- merge(table_diagnosis, mapped_occurences, by="Freq", all = TRUE)
table_diagnosis[is.na(table_diagnosis)] <- 0
table_diagnosis$pallet <- ifelse(table_diagnosis$color == 0, "#000000", table_diagnosis$pallet)
table_diagnosis$color <- as.factor(table_diagnosis$color)
table_diagnosis <- table_diagnosis[order(table_diagnosis$Var1),]
p<- ggplot(data=table_diagnosis, aes(x=Var1, y=Freq, fill=color)) +
geom_col() +
scale_y_continuous(limits = c(0,max(table_diagnosis$Freq)), expand = c(0, 0)) +
theme_bw() +
scale_fill_manual(values=append(cbbPalette, "#000000", 0)) +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.text.x = element_text(angle=90, hjust=1, vjust=0.5, colour = table_diagnosis$pallet))
p
# Next figure
tableau_data <- read.csv("~/Downloads/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
tableau_data <- read.csv("data/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
tableau_data <- read.csv("data/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
tableau_data <- read.csv("data/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
pwd
!pwd
tableau_data <- read.csv("data/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
"data/Cohort_Summary_data.csv"
tableau_data <- read.csv("data/Cohort_Summary_data.csv", sep='\t', fileEncoding = "UCS-2LE")
library(ggplot2)
library(dplyr)
library(tidyr)
library(egg)
library(gridExtra)
# Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, p4, p5, p6, ncol=3, nrow=2)
Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, p4, p5, p6, ncol=3, nrow=2)
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
# Figures Terra data
spreedsheet_small <- read.csv("Documentation/data/spreadsheet_small.tsv", sep='\t', fileEncoding = "utf-8")
# Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, p4, p5, p6, ncol=3, nrow=2)
p1
p4
# Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
# RNA
data_figure4 <- spreedsheet_small[spreedsheet_small["RNA_fastq1"] != "nan",]
data_figure4_p1 <- as.data.frame(table(data_figure4["PANEL_renamed_bai_file"]))
data_figure4_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure4_p1$Freq), length(data_figure4_p1$Var1)))
p1<- ggplot(data=data_figure4_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
### Why is this necessary?
data_figure4_p3 <- data_figure4_p3[data_figure4_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure4_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
data_figure4 <- spreedsheet_small[spreedsheet_small["RNA_fastq1"] != "nan",]
data_figure4_p1 <- as.data.frame(table(data_figure4["fastq1"]))
data_figure4_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure4_p1$Freq), length(data_figure4_p1$Var1)))
p1<- ggplot(data=data_figure4_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
### Why is this necessary?
data_figure4_p3 <- data_figure4_p3[data_figure4_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure4_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
data_figure4 <- spreedsheet_small[spreedsheet_small["RNA_fastq1"] != "nan",]
data_figure4_p1 <- as.data.frame(table(data_figure4["RNA_fastq1"]))
data_figure4_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure4_p1$Freq), length(data_figure4_p1$Var1)))
p1<- ggplot(data=data_figure4_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
### Why is this necessary?
data_figure4_p3 <- data_figure4_p3[data_figure4_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure4_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
# Figures Terra data
spreedsheet_small <- read.csv("Documentation/data/spreadsheet_small.tsv", sep='\t', fileEncoding = "utf-8")
# Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
# RNA
data_figure4 <- spreedsheet_small[spreedsheet_small["RNA_fastq1"] != "nan",]
data_figure4_p1 <- as.data.frame(table(data_figure4["RNA_fastq1"]))
data_figure4_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure4_p1$Freq), length(data_figure4_p1$Var1)))
p1<- ggplot(data=data_figure4_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
### Why is this necessary?
data_figure4_p3 <- data_figure4_p3[data_figure4_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure4_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
View(spreedsheet_small)
# Panel
data_figure3 <- spreedsheet_small[spreedsheet_small["PANEL_renamed_bai_file"] != "nan",]
#P1
data_figure3_p1 <- as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
data_figure3_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure3_p1$Freq), length(data_figure3_p1$Var1)))
p1<- ggplot(data=data_figure3_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure3_p3 <- as.data.frame(table(data_figure3["Dataset"]))
### Why is this necessary?
data_figure3_p3 <- data_figure3_p3[data_figure3_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure3_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P4
data_figure3_p4 <- as.data.frame(table(data_figure3["Media.type"]))
p4 <- ggplot(data=data_figure3_p4, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P5
data_figure3_p5 <- as.data.frame(table(data_figure3["Primary.Disease"]))
data_figure3_p5 <- data_figure3_p5[data_figure3_p5["Var1"] != "",]
p5 <- ggplot(data=data_figure3_p5, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P6
data_figure3_p6 <- as.data.frame(table(data_figure3["Dimension"]))
data_figure3_p6 <- data_figure3_p6[data_figure3_p6["Var1"] != "",]
p6 <- ggplot(data=data_figure3_p6, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
data_figure3_p1
data_figure3
data_figure3_p1
as.data.frame(table(data_figure3["PANEL_renamed_bai_file"]))
# RNA
data_figure4 <- spreedsheet_small[spreedsheet_small["RNA_fastq1"] != "nan",]
data_figure4_p1 <- as.data.frame(table(data_figure4["RNA_fastq1"]))
data_figure4_p1 <- data.frame(type=c("all", "unique"), y=c(sum(data_figure4_p1$Freq), length(data_figure4_p1$Var1)))
p1<- ggplot(data=data_figure4_p1, aes(x=type, y=y)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P2
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
### Why is this necessary?
data_figure4_p3 <- data_figure4_p3[data_figure4_p3["Var1"] != "",]
p3 <- ggplot(data=data_figure4_p3, aes(x="", y=Freq, fill=Var1)) + geom_bar(stat="identity", width=1) + coord_polar("y", start=0) + theme_void()
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
len(data_figure3)
len(data_figure3$X)
length(data_figure3$X)
data_figure3$PT.ID
data_figure3$SM.ID
data_figure3$Cell.Line
unique(data_figure3$Cell.Line)
len(unique(data_figure3$Cell.Line))
length(unique(data_figure3$Cell.Line))
length(unique(data_figure3$PANEL_renamed_bai_file))
length(data_figure4$X)
length(data_figure4$Cell.Line)
length(unique(data_figure4$RNA_fastq1))
data_figure4_p2 <- as.data.frame(table(data_figure4["Growth"]))
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq, fill=Var1)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
p2 <- ggplot(data=data_figure4_p2, aes(x="", y=Freq)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
#P3
data_figure4_p3 <- as.data.frame(table(data_figure4["Dataset"]))
p2 <- ggplot(data=data_figure4_p2, aes(x=Var1, y=Freq)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
p2 <- ggplot(data=data_figure4_p2, aes(x=Var1, y=Freq, fill=Var1)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
data_figure3_p2 <- as.data.frame(table(data_figure3["Growth"]))
p2 <- ggplot(data=data_figure3_p2, aes(x=Var1, y=Freq, fill=Var1)) +
geom_col() +
theme_bw() +
theme(panel.grid = element_blank(),
panel.border = element_blank(),
axis.ticks.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),)
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
data_figure4_p2
data_figure3_p2
